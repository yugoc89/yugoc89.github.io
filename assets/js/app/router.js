define(["jquery","underscore","backbone","classie","app/views"],function(t,e,i,o,n){var s=null,r=document.getElementById("loader"),a=i.Router.extend({url:"/",routes:{"":"homeAction","*default":"pageAction","services/":"servicesAction"},start:null,history:[],initialize:function(e){void 0===i.history.fragment&&(t(r).removeClass("show"),this.start=!0),this.on("all",this.storeRoute),this.on("all",this.ga)},storeRoute:function(){return this.history.push(i.history.fragment)},previous:function(){this.history.length>3?this.navigate("/"+this.history[this.history.length-3],!0):this.navigate("/",!0)},ga:function(){var t=i.history.getFragment();ga("send","pageview",{page:"/"+t})},homeAction:function(t){var e="/";this.switchView({url:e}),console.log("homeAction")},archiveAction:function(t){var e=t,i=t.split("/")[0];this.switchView({url:e,slug:i}),console.log("archiveAction")},servicesAction:function(t){var e=t;this.switchView({url:e,slug:"services"})},pageAction:function(t){var e="/"+t;this.switchView({url:e,slug:t,page:!0}),console.log("pageAction")},switchView:function(e){function i(i,o){function r(){t("html,body").animate({scrollTop:0},"slow")}o?(t(".container").append(i),r(),s=new n.MainView({el:i,id:e.slug,category:e.category,page:e.page,start:!0})):s=new n.MainView({el:i,id:e.slug,category:e.category,page:e.page})}function a(){t.ajax({url:e.url,cache:!1}).done(function(e){var o=t(".main",t(e));i(o,!0)}).fail(function(){alert("error"),o.remove(r,"show")})}r.removeAttribute("style"),o.add(r,"show"),s&&s.remove(),this.start===!0?i(".main"):a()}});return a});