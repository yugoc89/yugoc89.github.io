define(["jquery","underscore","backbone","classie","TweenLite","TimelineLite","MixItUp","app/router","app/collections","app/models","app/globals"],function(e,t,i,n,o,l,s,a,r,c,h){var u=document.getElementById("loader"),f=function(e){function t(){o.to(u,1,{alpha:0,ease:Sine.easeInOut,delay:1.5,onComplete:function(){n.remove(u,"show"),o.to(i,.4,{autoAlpha:0})}})}for(var i=document.getElementById("square"),s=i.getElementsByTagName("span"),a=s.length-1;a>=0;a--)s[a].style.backgroundColor=e;o.set(i,{autoAlpha:1});var r=new l({onComplete:t()});r.fromTo(".l1",1,{height:0},{height:"100%"}).fromTo(".l2",1,{width:0},{width:"100%"}).fromTo(".l3",1,{height:0},{height:"100%"}).fromTo(".l4",1,{width:0},{width:"100%"}),r.timeScale(3)},d=i.View.extend({el:e("#main"),initialize:function(i,n){e(this.el).unbind(),t.bindAll(this,"render"),this.category=i.category,this.page=i.page,this.start=i.start,this.render()},render:function(){"works"===this.id||"works/"===this.id?new g({el:this.el,id:this.id,category:this.category}):"services"===this.id||"services/"===this.id?new m({el:this.el,id:this.id}):this.page===!0?new v:new p(this.start===!0?{el:this.el}:{el:this.el,start:!0})}}),p=i.View.extend({events:{"click .main-menu a":"transitionEffect"},initialize:function(i,n){console.log("home!!"),this.start=i.start,e(this.el).unbind(),t.bindAll(this,"render","transitionEffect","mainAnim","subAnim"),this.render()},render:function(){var e=this;return this.delegateEvents(),f("#504f4f"),this.mainAnim(),setInterval(function(){e.subAnim()},6e3),this},transitionEffect:function(t){t.preventDefault();var i=require("app/router"),n=new i,o=e(t.currentTarget).attr("href");n.navigate(o,!0)},mainAnim:function(){e(this.el).find(".main-text").each(function(e,t){o.to(this,1,{alpha:1,delay:.5*e,repeat:-1,yoyo:!0,ease:Circ.easeInOut})})},subAnim:function(){var t=Math.floor(Math.random()*e(this.el).find(".main-text").length),i=".main-text-"+t,n=".main-text-"+(t-2),o=".main-text-"+(t+2),l=i+", "+n+", "+o;e(".main-text.active").removeClass("active"),e(l).addClass("active")}}),m=i.View.extend({el:e(".main"),initialize:function(){console.log("service page"),this.render()},render:function(){o.set(".content--services.bottom",{autoAlpha:0,y:"10%"}),this.setImageSize(),this.parallax(),f("#f6f4f4"),e(this.el).on("scroll",this.parallax),e(window).on("resize",this.setImageSize)},setImageSize:function(){var t=e(".section--title").width();e(".section--title").css({height:.69*t})},parallax:function(){var t=e(".main").scrollTop(),i=e(".content--services.bottom"),n=i.offset().top;e(".services-headline").css("top",80.5+-(.1*t)+"%"),e(".bg--business").css("top",4+-(.02*t)+"%"),e(".white-wall").css("top",70+-(.05*t)+"%"),t>n-80&&(o.to(i,1,{autoAlpha:1,y:"0%"}),o.to(".storyline",2,{height:"100%"}))}}),g=i.View.extend({el:e(".main"),events:{"click .ajax-trigger--single":"singleAjax","click .category-nav a":"cateFilter"},initialize:function(i){e(this.el).unbind(),t.bindAll(this,"render","singleAjax");var n=this;this.id=i.id,this.category=i.category,this.template=t.template(e("#template--index").html()),this.collection=new r.BasicCollection([],{id:this.id,category:this.category}),this.collection.fetch({success:function(e,t){n.render(t)},error:function(e){console.log(e)},complete:function(e,t){console.log(t)}})},render:function(){var t=this;this.delegateEvents(),console.log("archiveview");var i=this.collection.toJSON()[0].posts;e(".work-list").html(this.template({datums:i})),f("#fff"),e(".work-list").mixItUp(),e(".work-list").on("mixEnd",function(e,i){t.blurEffect()}),e(this.el).on("scroll",this.parallax)},singleAjax:function(t){t.preventDefault();var i,n=this,l=e(t.currentTarget).parents(".work-item"),s=e(".work-item").not(l),a=e(".work-item").length,r=e(window).scrollTop(),c=l.offset().top,h=c-r,u=e(window).height()/2-l.height()/2;i=0>h?u+Math.abs(h):u-Math.abs(h);var f=e(t.currentTarget).attr("href"),d=f.replace("/","").split("/")[1];1===a?o.to(l,.4,{y:i,ease:Circ.easeInOut,onComplete:function(){new w({el:n.el,slug:d})}}):o.to(s,.6,{alpha:0,onComplete:function(){o.to(l,.4,{y:i,ease:Circ.easeInOut,onComplete:function(){new w({el:n.el,slug:d})}})}})},cateFilter:function(t){t.preventDefault(),e(".category-nav a").removeClass("active"),n.add(t.currentTarget,"active"),this.blurEffect()},blurEffect:function(){var t=e(window).height()-e(window).height()/3;e(".work-item").each(function(i,n){var l=e(this).offset().top;l>t?o.set(this,{alpha:0,filter:"blur(4px)","-webkit-filter":"blur(4px)"}):o.set(this,{alpha:1,filter:"blur(0)","-webkit-filter":"blur(0)"})})},parallax:function(){e(".main").scrollTop();e(".work-item").each(function(t,i){var n=e(this).offset().top,l=1.5-n/100,s=e(window).height()-e(window).height()/3;80>n?o.to(this,1,{alpha:n/100+1,filter:"blur("+l+"px)","-webkit-filter":"blur("+l+"px)"}):s>n?o.to(this,.2,{alpha:1,filter:"blur(0)","-webkit-filter":"blur(0)"}):o.to(this,.6,{alpha:0,filter:"blur(10px)","-webkit-filter":"blur(10px)"})})}}),w=i.View.extend({el:e(".main"),events:{"click .single-post__close":"closeContent"},initialize:function(i){var n=this;this.id=i.id,this.slug=i.slug,this.template=t.template(e("#template--post").html()),this.collection=new r.SingleCollection([],{id:this.id,slug:this.slug}),this.collection.fetch({success:function(e,t){n.render(t)},error:function(e){console.log(e)},complete:function(e,t){console.log(t)}})},render:function(){var t=document.getElementById("single-post"),i=(document.getElementById("single-post-inner"),this.collection.toJSON()[0].posts);e(".single-post-inner").html(this.template({datums:i})),o.to("#button--close",.3,{autoAlpha:0,delay:.6}),o.to(t,.3,{autoAlpha:1,height:"100%",delay:.6,onComplete:function(){o.to(".overlay--single",.2,{width:"100%",onComplete:function(){o.to(".overlay--single",.2,{x:"100%"}),n.add(t,"show")}})}})},closeContent:function(t){t.preventDefault();var i=document.getElementById("single-post"),l=document.getElementById("single-post-inner");o.set(".work-item",{y:"0%",alpha:1}),o.to(".overlay--single",.2,{x:"0%",onComplete:function(){o.to(".overlay--single",.2,{width:"0%"})}}),o.to("#button--close",.1,{autoAlpha:1,onComplete:function(){e(l).empty(),n.remove(i,"show")}}),o.to(i,.6,{autoAlpha:0,delay:.6,onComplete:function(){o.set(i,{height:"0%"})}})}}),v=i.View.extend({el:e(".main"),initialize:function(){this.render()},render:function(){console.log("pageview"),f("#504f4f")}});return{MainView:d}});